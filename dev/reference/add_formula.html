<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add formula terms to a workflow — add_formula • workflows</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet"><!--optional theme--><link href="../tidymodels.css" rel="stylesheet"><meta property="og:title" content="Add formula terms to a workflow — add_formula"><meta property="og:description" content="

add_formula() specifies the terms of the model through the usage of a
formula.
remove_formula() removes the formula as well as any downstream objects
that might get created after the formula is used for preprocessing, such as
terms. Additionally, if the model has already been fit, then the fit is
removed.
update_formula() first removes the formula, then replaces the previous
formula with the new one. Any model that has already been fit based on this
formula will need to be refit.

"><meta property="og:image" content="https://workflows.tidymodels.org/logo.png"><meta name="twitter:card" content="summary"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">workflows</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://tidymodels.org" class="external-link">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.4.9002</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/stages.html">Workflow Stages</a>
</li>
<li>
  <a href="../articles/extras/getting-started.html">Getting Started</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/workflows/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add formula terms to a workflow</h1>
    <small class="dont-index">Source: <a href="https://github.com/tidymodels/workflows/blob/HEAD/R/pre-action-formula.R" class="external-link"><code>R/pre-action-formula.R</code></a></small>
    <div class="hidden name"><code>add_formula.Rd</code></div>
    </div>

    <div class="ref-description">
    
<ul><li><p><code>add_formula()</code> specifies the terms of the model through the usage of a
formula.</p></li>
<li><p><code>remove_formula()</code> removes the formula as well as any downstream objects
that might get created after the formula is used for preprocessing, such as
terms. Additionally, if the model has already been fit, then the fit is
removed.</p></li>
<li><p><code>update_formula()</code> first removes the formula, then replaces the previous
formula with the new one. Any model that has already been fit based on this
formula will need to be refit.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">add_formula</span><span class="op">(</span><span class="va">x</span>, <span class="va">formula</span>, <span class="va">...</span>, blueprint <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="fu">remove_formula</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="fu">update_formula</span><span class="op">(</span><span class="va">x</span>, <span class="va">formula</span>, <span class="va">...</span>, blueprint <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A workflow</p></dd>
<dt>formula</dt>
<dd><p>A formula specifying the terms of the model. It is advised to
not do preprocessing in the formula, and instead use a recipe if that is
required.</p></dd>
<dt>...</dt>
<dd><p>Not used.</p></dd>
<dt>blueprint</dt>
<dd><p>A hardhat blueprint used for fine tuning the preprocessing.</p>
<p>If <code>NULL</code>, <code><a href="https://rdrr.io/pkg/hardhat/man/default_formula_blueprint.html" class="external-link">hardhat::default_formula_blueprint()</a></code> is used and is passed
arguments that best align with the model present in the workflow.</p>
<p>Note that preprocessing done here is separate from preprocessing that
might be done by the underlying model. For example, if a blueprint with
<code>indicators = "none"</code> is specified, no dummy variables will be created by
hardhat, but if the underlying model requires a formula interface that
internally uses <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">stats::model.matrix()</a></code>, factors will still be expanded to
dummy variables by the model.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>x</code>, updated with either a new or removed formula preprocessor.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>To fit a workflow, exactly one of <code>add_formula()</code>, <code><a href="add_recipe.html">add_recipe()</a></code>, or
<code><a href="add_variables.html">add_variables()</a></code> <em>must</em> be specified.</p>
    </div>
    <div id="formula-handling">
    <h2>Formula Handling</h2>
    <p>Note that, for different models, the formula given to <code>add_formula()</code>
might be handled in different ways, depending on the parsnip model being
used. For example, a random forest model fit using ranger would not
convert any factor predictors to binary indicator variables. This is
consistent with what <code>ranger::ranger()</code> would do, but is inconsistent
with what <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">stats::model.matrix()</a></code> would do.</p>
<p>The documentation for parsnip models provides details about how the data
given in the formula are encoded for the model if they diverge from the
standard <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> methodology. Our goal is to be consistent with
how the underlying model package works.</p><div class="section">
<h3 id="how-is-this-formula-used-">How is this formula used?<a class="anchor" aria-label="anchor" href="#how-is-this-formula-used-"></a></h3>


<p>To demonstrate, the example below uses <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> to fit a model. The
formula given to <code>add_formula()</code> is used to create the model matrix and
that is what is passed to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> with a simple formula of
<code>body_mass_g ~ .</code>:</p><div class="sourceCode r"><pre><code><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parsnip.tidymodels.org" class="external-link">parsnip</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflows" class="external-link">workflows</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modeldata.tidymodels.org" class="external-link">modeldata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/hardhat" class="external-link">hardhat</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>

<span class="va">lm_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html" class="external-link">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span>

<span class="va">lm_wflow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">lm_mod</span><span class="op">)</span>

<span class="va">pre_encoded</span> <span class="op">&lt;-</span> <span class="va">lm_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/add_formula.html">add_formula</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">island</span> <span class="op">+</span> <span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span>

<span class="va">pre_encoded_parsnip_fit</span> <span class="op">&lt;-</span> <span class="va">pre_encoded</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/hardhat/man/hardhat-extract.html" class="external-link">extract_fit_parsnip</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">pre_encoded_fit</span> <span class="op">&lt;-</span> <span class="va">pre_encoded_parsnip_fit</span><span class="op">$</span><span class="va">fit</span>

<span class="co"># The `lm()` formula is *not* the same as the `add_formula()` formula: </span>
<span class="va">pre_encoded_fit</span></code></pre><p></p></div><div class="sourceCode"><pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## stats::lm(formula = ..y ~ ., data = data)</span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##      (Intercept)  speciesChinstrap     speciesGentoo  </span>
<span class="co">##        -1009.943             1.328          2236.865  </span>
<span class="co">##      islandDream   islandTorgersen     bill_depth_mm  </span>
<span class="co">##            9.221           -18.433           256.913</span></code></pre></div>

<p>This can affect how the results are analyzed. For example, to get
sequential hypothesis tests, each individual term is tested:</p><div class="sourceCode r"><pre><code><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">pre_encoded_fit</span><span class="op">)</span></code></pre><p></p></div><div class="sourceCode"><pre><code><span class="co">## Analysis of Variance Table</span>
<span class="co">## </span>
<span class="co">## Response: ..y</span>
<span class="co">##                   Df    Sum Sq   Mean Sq  F value Pr(&gt;F)    </span>
<span class="co">## speciesChinstrap   1  18642821  18642821 141.1482 &lt;2e-16 ***</span>
<span class="co">## speciesGentoo      1 128221393 128221393 970.7875 &lt;2e-16 ***</span>
<span class="co">## islandDream        1     13399     13399   0.1014 0.7503    </span>
<span class="co">## islandTorgersen    1       255       255   0.0019 0.9650    </span>
<span class="co">## bill_depth_mm      1  28051023  28051023 212.3794 &lt;2e-16 ***</span>
<span class="co">## Residuals        336  44378805    132080                    </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>

</div>

<div class="section">
<h3 id="overriding-the-default-encodings">Overriding the default encodings<a class="anchor" aria-label="anchor" href="#overriding-the-default-encodings"></a></h3>


<p>Users can override the model-specific encodings by using a hardhat
blueprint. The blueprint can specify how factors are encoded and whether
intercepts are included. As an example, if you use a formula and would
like the data to be passed to a model untouched:</p><div class="sourceCode r"><pre><code><span class="va">minimal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hardhat/man/default_formula_blueprint.html" class="external-link">default_formula_blueprint</a></span><span class="op">(</span>indicators <span class="op">=</span> <span class="st">"none"</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">un_encoded</span> <span class="op">&lt;-</span> <span class="va">lm_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/add_formula.html">add_formula</a></span><span class="op">(</span>
    <span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">island</span> <span class="op">+</span> <span class="va">bill_depth_mm</span>, 
    blueprint <span class="op">=</span> <span class="va">minimal</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span>

<span class="va">un_encoded_parsnip_fit</span> <span class="op">&lt;-</span> <span class="va">un_encoded</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/hardhat/man/hardhat-extract.html" class="external-link">extract_fit_parsnip</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">un_encoded_fit</span> <span class="op">&lt;-</span> <span class="va">un_encoded_parsnip_fit</span><span class="op">$</span><span class="va">fit</span>

<span class="va">un_encoded_fit</span></code></pre><p></p></div><div class="sourceCode"><pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## stats::lm(formula = ..y ~ ., data = data)</span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##      (Intercept)     bill_depth_mm  speciesChinstrap  </span>
<span class="co">##        -1009.943           256.913             1.328  </span>
<span class="co">##    speciesGentoo       islandDream   islandTorgersen  </span>
<span class="co">##         2236.865             9.221           -18.433</span></code></pre></div>

<p>While this looks the same, the raw columns were given to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> and that
function created the dummy variables. Because of this, the sequential
ANOVA tests groups of parameters to get column-level p-values:</p><div class="sourceCode r"><pre><code><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">un_encoded_fit</span><span class="op">)</span></code></pre><p></p></div><div class="sourceCode"><pre><code><span class="co">## Analysis of Variance Table</span>
<span class="co">## </span>
<span class="co">## Response: ..y</span>
<span class="co">##                Df    Sum Sq  Mean Sq F value Pr(&gt;F)    </span>
<span class="co">## bill_depth_mm   1  48840779 48840779 369.782 &lt;2e-16 ***</span>
<span class="co">## species         2 126067249 63033624 477.239 &lt;2e-16 ***</span>
<span class="co">## island          2     20864    10432   0.079 0.9241    </span>
<span class="co">## Residuals     336  44378805   132080                   </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>

</div>

<div class="section">
<h3 id="overriding-the-default-model-formula">Overriding the default model formula<a class="anchor" aria-label="anchor" href="#overriding-the-default-model-formula"></a></h3>


<p>Additionally, the formula passed to the underlying model can also be
customized. In this case, the <code>formula</code> argument of <code><a href="add_model.html">add_model()</a></code> can be
used. To demonstrate, a spline function will be used for the bill depth:</p><div class="sourceCode r"><pre><code><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span>

<span class="va">custom_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/add_model.html">add_model</a></span><span class="op">(</span>
    <span class="va">lm_mod</span>, 
    formula <span class="op">=</span> <span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">island</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">bill_depth_mm</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/add_formula.html">add_formula</a></span><span class="op">(</span>
    <span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">island</span> <span class="op">+</span> <span class="va">bill_depth_mm</span>, 
    blueprint <span class="op">=</span> <span class="va">minimal</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span>

<span class="va">custom_parsnip_fit</span> <span class="op">&lt;-</span> <span class="va">custom_formula</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/hardhat/man/hardhat-extract.html" class="external-link">extract_fit_parsnip</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">custom_fit</span> <span class="op">&lt;-</span> <span class="va">custom_parsnip_fit</span><span class="op">$</span><span class="va">fit</span>

<span class="va">custom_fit</span></code></pre><p></p></div><div class="sourceCode"><pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## stats::lm(formula = body_mass_g ~ species + island + ns(bill_depth_mm, </span>
<span class="co">##     3), data = data)</span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##           (Intercept)       speciesChinstrap          speciesGentoo  </span>
<span class="co">##              1959.090                  8.534               2352.137  </span>
<span class="co">##           islandDream        islandTorgersen  ns(bill_depth_mm, 3)1  </span>
<span class="co">##                 2.425                -12.002               1476.386  </span>
<span class="co">## ns(bill_depth_mm, 3)2  ns(bill_depth_mm, 3)3  </span>
<span class="co">##              3187.839               1686.996</span></code></pre></div>

</div>

<div class="section">
<h3 id="altering-the-formula">Altering the formula<a class="anchor" aria-label="anchor" href="#altering-the-formula"></a></h3>


<p>Finally, when a formula is updated or removed from a fitted workflow,
the corresponding model fit is removed.</p><div class="sourceCode r"><pre><code><span class="va">custom_formula_no_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_formula.html">update_formula</a></span><span class="op">(</span><span class="va">custom_formula</span>, <span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/hardhat/man/hardhat-extract.html" class="external-link">extract_fit_parsnip</a></span><span class="op">(</span><span class="va">custom_formula_no_fit</span><span class="op">)</span><span class="op">)</span></code></pre><p></p></div><div class="sourceCode"><pre><code><span class="co">## Error : The workflow does not have a model fit. Have you called `fit()` yet?</span></code></pre></div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">workflow</span> <span class="op">&lt;-</span> <span class="fu"><a href="workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">workflow</span> <span class="op">&lt;-</span> <span class="fu">add_formula</span><span class="op">(</span><span class="va">workflow</span>, <span class="va">mpg</span> <span class="op">~</span> <span class="va">cyl</span><span class="op">)</span></span>
<span class="r-in"><span class="va">workflow</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ══ Workflow ════════════════════════════════════════════════════════════════════</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Preprocessor:</span> Formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Model:</span> None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── Preprocessor ────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mpg ~ cyl</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">remove_formula</span><span class="op">(</span><span class="va">workflow</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ══ Workflow ════════════════════════════════════════════════════════════════════</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Preprocessor:</span> None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Model:</span> None</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">update_formula</span><span class="op">(</span><span class="va">workflow</span>, <span class="va">mpg</span> <span class="op">~</span> <span class="va">disp</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ══ Workflow ════════════════════════════════════════════════════════════════════</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Preprocessor:</span> Formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Model:</span> None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── Preprocessor ────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mpg ~ disp</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="tidyverse">
  <p><code>workflows</code> is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer></div>

  


  

  </body></html>

